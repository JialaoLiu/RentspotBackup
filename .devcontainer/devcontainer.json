{
    "name": "Web & Database Computing - RentSpot",
    "image": "ghcr.io/uadelaide/wdc23:latest",

    // Forward ports
    "forwardPorts": [8080, 5173],
    "portsAttributes": {
        "8080": {
            "label": "Backend API",
            "onAutoForward": "notify"
        },
        "5173": {
            "label": "Frontend Dev Server",
            "onAutoForward": "openBrowser"
        }
    },

    // Configure tool-specific properties
    "customizations": {
        "vscode": {
            "extensions": [
                "html-validate.vscode-html-validate",
                "dbaeumer.vscode-eslint",
                "vsls-contrib.gitdoc",
                "ms-vsliveshare.vsliveshare-pack",
                "tonybaloney.vscode-pets",
                "unjinjang.rest-api-client",
                "Vue.volar",
                "cweijan.vscode-database-client2"
            ]
        }
    },

    // Force AMD64 architecture
    "runArgs": ["--platform=linux/amd64"],

    // Auto-setup everything after container creation
    "postCreateCommand": "bash -c 'service mysql start && sleep 5 && mysql -u root -e \"CREATE DATABASE IF NOT EXISTS Rent_database;\" && if [ -f \"/workspaces/*/backend/Rent_database_updated.sql\" ]; then mysql -u root Rent_database < /workspaces/*/backend/Rent_database_updated.sql; fi && cd /workspaces/*/backend && cat > .env << \"EOF\"\nDB_HOST=localhost\nDB_USER=root\nDB_PASSWORD=\nDB_NAME=Rent_database\nDB_PORT=3306\nJWT_SECRET=00ae84691b5cc7bb6ca21e11779bc0cefb5ed62d1b7331a71ea0628e7f2c98d54331b54f3c67084bc2ec0e78e9ef21473b9b575eb7e8336dc5faebdafb44dacf\nPORT=8080\nCLOUDINARY_CLOUD_NAME=dzxrmtus9\nCLOUDINARY_API_KEY=138993529279886\nCLOUDINARY_API_SECRET=23CK6Atf0I_PolCywakizy-PJU8\nTURNSTILE_SITE_KEY=0x4AAAAAABdkinnD2a45uxc0\nTURNSTILE_SECRET_KEY=0x4AAAAAABdkii48VRRJP3Cb8Ggbml6zNyQ\nNEWS_API_KEY=d9b129de2e5e432e8315073b3e294fc3\nEOF\necho \"Backend .env created\" && npm install && cd ../rentspot-frontend && cat > .env << \"EOF\"\nVUE_APP_API_BASE_URL=\nVUE_APP_CLOUDINARY_CLOUD_NAME=dzxrmtus9\nVUE_APP_CLOUDINARY_UPLOAD_PRESET=rentspot_unsigned\nVUE_APP_TURNSTILE_SITE_KEY=0x4AAAAAABdkinnD2a45uxc0\nVUE_APP_TURNSTILE_TEST_SITE_KEY=1x00000000000000000000AA\nVUE_APP_NEWS_API_KEY=d9b129de2e5e432e8315073b3e294fc3\nEOF\necho \"Frontend .env created\" && npm install && /workspaces/*/.devcontainer/setup-api-url.sh && echo \"Setup complete! Backend: cd backend && npm start | Frontend: cd rentspot-frontend && npm run serve\"'",

    // Start database on every container restart  
    "postStartCommand": "bash -c 'service mysql start && sleep 2 && mysql -u root -e \"CREATE DATABASE IF NOT EXISTS Rent_database;\" 2>/dev/null || true'",

    // Use root user (as per course requirement)
    "remoteUser": "root",

    // Default settings (keeping course requirements)
    "settings": {
        "extension-uninstaller.uninstall": [
            "github.copilot",
            "github.copilot-nightly", 
            "tabnine.tabnine-vscode",
            "timkmecl.chatgpt"
        ],
        "extensions.ignoreRecommendations": true,
        "files.autoSave": "afterDelay",
        "files.exclude": {
            "**/.*": true
        },
        "files.trimTrailingWhitespace": true,
        "files.watcherExclude": {
            "**/.git/objects/**": true,
            "**/.git/subtree-cache/**": true,
            "**/node_modules/*/**": true
        },
        "git.autofetch": true,
        "gitdoc.autoPull": "off",
        "gitdoc.commitMessageFormat": "DD, TTT",
        "gitdoc.commitValidationLevel": "none",
        "gitdoc.enabled": false,
        "gitdoc.pullOnOpen": false,
        "terminal.integrated.defaultProfile.linux": "bash"
    }
}